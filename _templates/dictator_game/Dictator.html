{% load static %}{% extends "global/Page.html" %}
{% block styles %}
<link rel="stylesheet" href="{% static 'css/dictator_game/dg.css' %}">
<style>
/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dg-grid    {display:grid;grid-gap:24px;
             grid-template-columns:repeat(2,1fr);}
@media(max-width: 768px){
    .dg-grid{grid-template-columns:1fr;}
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Card look â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.dg-card   {border-radius:8px;padding:20px;
            background:#fff;text-align:center;
            transition:.2s box-shadow,.2s transform;}
.dg-card:hover{transform:scale(1.02);
               box-shadow:0 4px 10px rgba(0,0,0,.1);}

.bonus-card  {background:#f0f8ff;border:1px solid #d0e7ff;}
.donate-card {background:#fff8e1;border:1px solid #ffe082;}
.charity-card{background:#f5fff0;border:1px solid #d8ffd0;}

/* live summary text */
#keepVal,#sponsorVal,#charityVal{font-weight:bold;}

/* button */
.btn-donate{background:#28a745;border:0;color:#fff;}
.btn-donate:hover{background:#218838}

.dg-info {color:#333;}  
</style>
{% endblock %}

{% block content %}
<input type="hidden" id="id_browser"      name="browser">
<input type="hidden" id="id_blur_count"   name="blur_count"  value="0">
<input type="hidden" id="id_blur_log"     name="blur_log">
<input type="hidden" id="id_blur_warned"  name="blur_warned" value="0">

<!-- load data-quality script AFTER the hidden inputs -->
<script src="{% static 'js/data_quality.js' %}"></script>

<!-- hidden flags for dg.js -->
<div id="dg-data"
     data-impact-level="{{ impact_level }}"
     data-image="{% if image_on %}true{% else %}false{% endif %}"></div>

<div class="container mt-4">
  <div class="dg-grid">

    <!-- LEFT COL: bonus + input -->
    <div>
      <!-- Bonus overview -->
      <div class="dg-card bonus-card mb-4">
        <h4 class="mb-3">Your bonus endowment</h4>
        <p>You have <strong>100 points ($1.00)</strong> you can keep or send
           to the charity.</p>

        {% if impact_level == 1 %}
            <p class="dg-info">
            â€¢ A sponsor has <strong>already donated $1.00</strong> for you.<br>
            â€¢ Every point you send further adds <strong>1 p</strong> to AMF.
            </p>
        {% elif impact_level == 2 %}
          <p class="dg-info mb-0">
            â€¢ A sponsor has <strong>already donated&nbsp;$1.00</strong> for you.<br>
              <u>Every point you send is permanently removed from the study</u>;
              it does <strong>not</strong> reach the charity and does <strong>not</strong> reduce the sponsorâ€™s payment.<br>
              AMF therefore still receives <strong>exactly $1.00</strong>.
          </p>
        
        {% else %}
          <p class="dg-info mb-0">
          â€¢ A sponsor has <strong>already donated $1.00</strong> for you.<br>
            For every point you give, the sponsor <strong>withdraws the same
            amount</strong>.&nbsp;AMF therefore still receives <strong>$1.00
            in total</strong>.
        </p>
        {% endif %}

        {% if image_on %}
          <p class="mt-2 text-primary">ğŸ‘ One randomly matched participant will see how much you donatedâ€”but not your name or identity (only part of your Prolific ID will be shown).</p>
        {% else %}
          <p class="mt-2 text-muted">ğŸ”’ Your decision is private. <br>
          </p>
        {% endif %}
      </div>

      <!-- Donation input -->
      <div class="dg-card donate-card">
        <h4 class="mb-3">Indicate your donation</h4>

        <div class="form-group">
          <label for="donationBox">Points to send (0-100):</label>
          <input type="number" id="donationBox" name="donation"
                 class="form-control w-50 mx-auto"
                 min="0" max="100" step="1" required>
        </div>

        <p class="mt-3">
          You keep: <span id="keepVal">$1.00</span><br>
          AMF receives:
          <span id="sponsorVal">
                {% if impact_level == 0 or impact_level == 2 %}$1.00{% else %}$1.00{% endif %}
          </span> (lead donor)
          +
          <span id="charityVal"
                class="{% if impact_level == 1 %}text-success{% endif %}">
                {% if impact_level == 1 %}$0.00{% else %}$0.00{% endif %}
          </span> (you)
      </p>

        {% next_button tag="button" id="continueBtn" class="btn btn-donate mt-2" %}

      </div>
    </div>

    <!-- RIGHT COL: charity info -->
    <div>
      <div class="dg-card charity-card">
        <h4 class="mb-3">Against Malaria Foundation</h4>
        <img src="{% static 'dictator_game/against_malaria_foundation.jpg' %}"
             alt="Bed-net distribution" class="img-fluid rounded mb-3">
        <ul class="list-unstyled text-start">
          <li>âœ… Distributes long-lasting insecticide nets.</li>
          <li>ğŸ’¡ Independent evaluations rank AMF as one of the
              most cost-effective charities worldwide.</li>
          <li>ğŸ’¸ Every $2 funds one anti-malaria net â€” your donation helps make this happen.</li>
          <li>ğŸ¦Ÿ Each net protects 2 people from malaria for 3 years.</li>
        </ul>
      </div>
    </div>

  </div><!-- dg-grid -->
</div><!-- container -->

<script src="{% static 'js/dictator_game/dg.js' %}"></script>
{% endblock %}
